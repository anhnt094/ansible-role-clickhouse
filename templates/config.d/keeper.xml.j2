{% if clickhouse_config_format == 'xml' %}
<?xml version="1.0"?>
<!--
  ClickHouse Keeper Client Configuration
  Generated by Ansible - ansible-role-clickhouse
  This configures ClickHouse Server to connect to ClickHouse Keeper ensemble
-->
<clickhouse>
    <!-- ClickHouse Keeper (ZooKeeper replacement) -->
    <zookeeper>
{% for host in groups['clickhouse_keeper'] %}
        <node>
            <host>{{ hostvars[host]['access_ip'] | default(hostvars[host]['ip']) | default(hostvars[host]['ansible_host']) }}</host>
            <port>{{ clickhouse_keeper_port }}</port>
        </node>
{% endfor %}
    </zookeeper>
</clickhouse>
{% elif clickhouse_config_format == 'yaml' %}
# ClickHouse Keeper Client Configuration
# Generated by Ansible - ansible-role-clickhouse

clickhouse:
  zookeeper:
    nodes:
{% for host in groups['clickhouse_keeper'] %}
      - host: {{ hostvars[host]['access_ip'] | default(hostvars[host]['ip']) | default(hostvars[host]['ansible_host']) }}
        port: {{ clickhouse_keeper_port }}
{% endfor %}
{% endif %}
