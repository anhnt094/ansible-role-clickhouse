{% if clickhouse_config_format == 'xml' %}
<?xml version="1.0"?>
<!--
  Network Configuration
  Generated by Ansible - ansible-role-clickhouse
  Best Practice: Keep default config.xml unchanged, add customizations in config.d/
-->
<clickhouse>
    <!-- Listen host for client connections -->
    <listen_host>{{ clickhouse_listen_host }}</listen_host>
    
    <!-- Explicitly disable IPv6 localhost if we're binding to IPv4 only -->
    <listen_host remove="1">::1</listen_host>
    
{% if clickhouse_listen_host != '0.0.0.0' and clickhouse_listen_host != '127.0.0.1' %}
    <!-- Also listen on localhost for local connections -->
    <listen_host>127.0.0.1</listen_host>
{% endif %}
</clickhouse>
{% elif clickhouse_config_format == 'yaml' %}
# Network Configuration
# Generated by Ansible - ansible-role-clickhouse
# Best Practice: Keep default config.xml unchanged, add customizations in config.d/

clickhouse:
  listen_host:
    - {{ clickhouse_listen_host }}
{% if clickhouse_listen_host != '0.0.0.0' and clickhouse_listen_host != '127.0.0.1' %}
    - 127.0.0.1
{% endif %}
{% endif %}
